<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.web.app.mapper.ProductMapper" >
    <!-- 产品表 -->
	<resultMap id="BaseResultMap" type="com.web.app.entity.Product" >
		<id column="id" property="id" jdbcType="VARCHAR" />
		<result column="product_sn" property="productSn" jdbcType="VARCHAR" />
		<result column="category_id" property="categoryId" jdbcType="VARCHAR" />
		<result column="product_name" property="productName" jdbcType="VARCHAR" />
		<result column="click_count" property="clickCount" jdbcType="INTEGER" />
		<result column="market_price" property="marketPrice" jdbcType="DECIMAL" />
		<result column="product_price" property="productPrice" jdbcType="DECIMAL" />
		<result column="brief" property="brief" jdbcType="VARCHAR" />
		<result column="product_details" property="productDetails" jdbcType="VARCHAR" />
		<result column="is_on_sale" property="isOnSale" jdbcType="INTEGER" />
		<result column="is_not" property="isHot" jdbcType="INTEGER" />
		<result column="sort_order" property="sortOrder" jdbcType="INTEGER" />
		<result column="product_unit" property="productUnit" jdbcType="VARCHAR" />
		<result column="stock" property="stock" jdbcType="INTEGER" />
	    <result column="product_color" property="productColor" jdbcType="VARCHAR" />
	    <result column="product_area" property="productArea" jdbcType="VARCHAR" />
	    <result column="material" property="material" jdbcType="VARCHAR" />
	    <result column="pro_tag" property="proTag" jdbcType="VARCHAR" />
	    <result column="size_l" property="sizeL" jdbcType="INTEGER" />
	    <result column="size_w" property="sizeW" jdbcType="INTEGER" />
	    <result column="size_h" property="sizeH" jdbcType="INTEGER" />
	    <result column="sell_count" property="sellCount" jdbcType="INTEGER" />
	    <result column="create_user" property="createUser" jdbcType="VARCHAR" />
	    <result column="create_date" property="createDate" jdbcType="VARCHAR" />
	    <result column="last_update" property="lastUpdate" jdbcType="VARCHAR" />
	    <result column="product_status" property="productStatus" jdbcType="INTEGER" />
	    <result column="is_delete" property="isDelete" jdbcType="INTEGER" />
	</resultMap>
 
	<!-- SQL语句段 -->
	<sql id="base_column_list" >
	  id, brief, category_id ,click_count, create_date, create_user, is_delete, 
	  is_hot, is_on_sale, last_update, market_price, material, pro_tag, product_area, 
	  product_color, product_details, product_name, product_price, product_sn, 
	  product_status, product_unit, sell_count, size_l,size_w,size_h, sort_order, stock
	</sql>
	
	<!-- 添加类别 -->
	<insert id="insertProduct" parameterType="com.web.app.entity.Product">
		insert into t_product(
		   id,
		   brief,
		   category_id,
		   click_count,
		   create_date,
		   create_user,
		   is_delete,
		   is_hot,
		   is_on_sale,
		   last_update,
		   market_price,
		   material,
		   pro_tag,
		   product_area,
		   product_color,
		   product_details,
		   product_name,
		   product_price,
		   product_sn,
		   product_status,
		   product_unit,
		   sell_count,
		   sort_order,
		   size_l,
		   size_w,
		   size_h,
		   stock)
		values(
		   #{id},
		   #{brief},
		   #{categoryId},
		   #{clickCount},
		   #{createDate},
		   #{createUser},
		   #{isDelete},
		   #{isHot},
		   #{isOnSale},
		   #{lastUpdate},
		   #{marketPrice},
		   #{material},
		   #{proTag},
		   #{productArea},
		   #{productColor},
		   #{productDetails},
		   #{productName},
		   #{productPrice},
		   #{productSn},
		   #{productStatus},
		   #{productUnit},
		   #{sellCount},
		   #{sortOrder},
		   #{sizeL},
		   #{sizeW},
		   #{sizeH},
		   #{stock})
	</insert>
	
	<!-- 查询所产品 -->
	<select id="getAllProduct" parameterType="java.util.Map" resultMap="BaseResultMap" >
        select
        <include refid="base_column_list" />
            from t_product where is_delete = 0
        <if test="createDate != null">
        	ORDER BY create_date DESC
        </if>
        <if test="isHot != null">
        	and is_hot = 0
        </if>
        <if test="sellCount != null">
        	ORDER BY sell_count DESC
        </if>
        <if test="priceUp != null">
        	ORDER BY product_price ASC
        </if>
        <if test="priceDown != null">
        	ORDER BY product_price DESC
        </if>
        <if test="categoryId != null">
        	and category_id = #{categoryId}
        </if>
        <if test="productColor != null">
        	and product_color = #{productColor}
        </if>
        <if test="material != null">
        	and material = #{material}
        </if>
        <if test="startIndex != null and endIndex != null">
        	limit ${startIndex},${endIndex}
        </if>
    </select>
    
    <!-- 查询产品个数 -->
    <select id="countByCriteria" resultType="java.lang.Integer">
		select count(*) from t_product where is_delete = 0
	</select>
	
	<!-- 根据id查询 -->
    <select id="getProductById" parameterType="java.lang.String" resultMap="BaseResultMap">
		select * from t_product where id = #{id}
	</select>
	
	<!-- 根据ID修改 -->
	<update id="updateProductById" parameterType="com.web.app.entity.Product">
	    update t_product
		<set>
	      <if test="brief != null" >
	        brief = #{brief, jdbcType=VARCHAR},
	      </if>
	      <if test="categoryId != null">
	      	category_id = #{categoryId, jdbcType=VARCHAR},
	      </if>
	      <if test="clickCount != null">
	        click_count = #{clickCount, jdbcType=INTEGER},
	      </if>
	      <if test="createDate != null">
	        create_date = #{createDate, jdbcType=VARCHAR},
	      </if>
	      <if test="createUser != null">
	        create_user = #{createUser, jdbcType=VARCHAR},
	      </if>
	      <if test="isHot != null">
	        is_hot = #{isHot, jdbcType=INTEGER},
	      </if>
	      <if test="isOnSale != null">
	        is_on_sale = #{isOnSale, jdbcType=INTEGER},
	      </if>
	      <if test="lastUpdate != null">
	        last_update = #{lastUpdate, jdbcType=VARCHAR},
	      </if>
	      <if test="marketPrice != null">
	        market_price = #{marketPrice, jdbcType=DECIMAL},
	      </if>
	      <if test="material != null">
	        material = #{material, jdbcType=VARCHAR},
	      </if>
	      <if test="proTag != null">
	        pro_tag = #{proTag, jdbcType=VARCHAR},
	      </if>
	      <if test="productArea != null">
	        product_area = #{productArea, jdbcType=VARCHAR},
	      </if>
		  <if test="productColor != null">
	        product_color = #{productColor, jdbcType=VARCHAR},
	      </if>
	      <if test="productDetails != null">
	        product_details = #{productDetails, jdbcType=VARCHAR},
	      </if>
		  <if test="productName != null">
	        product_name = #{productName, jdbcType=VARCHAR},
	      </if>
		  <if test="productPrice != null">
	        product_price = #{productPrice, jdbcType=DECIMAL},
	      </if>
	      <if test="productSn != null">
	        product_sn = #{productSn, jdbcType=VARCHAR},
	      </if>
		  <if test="productStatus != null">
	        product_status = #{productStatus, jdbcType=INTEGER},
	      </if>
	      <if test="productUnit != null">
	        product_unit = #{productUnit, jdbcType=VARCHAR},
	      </if>
		  <if test="sellCount != null">
	        sell_count = #{sellCount, jdbcType=INTEGER},
	      </if>
		  <if test="sortOrder != null">
	        sort_order = #{sortOrder, jdbcType=INTEGER},
	      </if>
	      <if test="sizeL != null">
	        size_l = #{sizeL, jdbcType=INTEGER},
	      </if>
	      <if test="sizeW != null">
	        size_w = #{sizeW, jdbcType=INTEGER},
	      </if>
	      <if test="sizeH != null">
	        size_h = #{sizeH, jdbcType=INTEGER},
	      </if>
		  <if test="stock != null">
	        stock = #{stock, jdbcType=INTEGER}
	      </if>
	    </set>
	    where id = #{id, jdbcType=VARCHAR} and is_delete = 0
	</update>
	
	<!-- 根据ID删除 -->
	<update id="deleteProductById" parameterType="java.lang.String">
		update t_product set is_delete = 1 where id in
        <foreach item="idItem" collection="array" open="(" separator="," close=")">
           #{idItem}
        </foreach>
	</update>
	
	<!-- 根据ID修改 -->
	<!-- <update id="updateCategoryById" parameterType="com.web.app.entity.Category">
	    update t_category
		<set>
	      <if test="catName != null" >
	        cat_name = #{catName, jdbcType=VARCHAR},
	      </if>
	      <if test="depth != null">
	      	depth = #{depth, jdbcType=INTEGER},
	      </if>
	      <if test="parentId != null">
	        parent_id = #{parentId, jdbcType=VARCHAR},
	      </if>
	      <if test="priority != null">
	        priority = #{priority, jdbcType=INTEGER}
	      </if>
	    </set>
	    where id = #{id, jdbcType=VARCHAR} and is_delete = 0
	</update> -->
</mapper>



